name: ğŸš€ Deploy to GitHub Pages

on:
  workflow_run:
    workflows: ["ğŸ”’ CI Gate"]
    types: [completed]
    branches: [main]

jobs:
  deploy:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: ubuntu-latest
    permissions: { contents: read, pages: write, id-token: write }
    environment: { name: github-pages, url: ${{ steps.deployment.outputs.page_url }} }
    # âœ… æ­£ç¡®ï¼šåªæœ‰2å¯¹èŠ±æ‹¬å·ï¼ˆå…±4ä¸ªèŠ±æ‹¬å·å­—ç¬¦ï¼‰
    
    steps:
      - name: ğŸ› ï¸ Setup Pages
        uses: actions/configure-pages@v4
        
      - name: ğŸ“¥ Download artifact from successful CI run
        uses: actions/download-artifact@v4
        with: { github-token: ${{ secrets.GITHUB_TOKEN }}, run-id: ${{ github.event.workflow_run.id }} }
        
      - name: ğŸš€ Upload artifact and deploy
        uses: actions/upload-pages-artifact@v3
        with: { path: './dist' }
        
      - name: ğŸš€ Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
